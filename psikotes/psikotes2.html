<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Profesional - Terintegrasi Database</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #eef2f7; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .quiz-container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 500px; }
        .input-group { text-align: left; margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
        
        .status-container { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 20px; justify-content: center; }
        .num-box { width: 35px; height: 35px; border-radius: 5px; display: flex; align-items: center; justify-content: center; border: 1px solid #ccc; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .num-unanswered { background: #f8f9fa; color: #999; }
        .num-answered { background: #2ecc71 !important; color: white; border-color: #27ae60; }
        .num-active { background: #3498db !important; color: white; border-color: #2980b9; transform: scale(1.1); }
        
        /* Warna Hasil Akhir */
        .num-correct { background: #2ecc71 !important; color: white; border-color: #27ae60; }
        .num-wrong { background: #e74c3c !important; color: white; border-color: #c0392b; }

        .option-btn { width: 100%; text-align: left; padding: 12px; margin-bottom: 10px; border: 2px solid #eee; border-radius: 8px; background: white; cursor: pointer; font-size: 15px; transition: 0.2s; }
        .option-btn:hover:not(:disabled) { border-color: #3498db; background: #f7fbff; }
        .option-btn.selected { border-color: #3498db; background: #3498db; color: white; }
        .option-btn:disabled { cursor: default; opacity: 0.8; }
        .option-btn.correct-ans { border: 2px solid #2ecc71; background: #e8f5e9; color: #2e7d32; }
        
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 20px; gap: 10px; }
        .btn { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; flex: 1; font-size: 14px; transition: 0.3s; }
        .btn-blue { background: #3498db; color: white; }
        .btn-blue:disabled { background: #bdc3c7; cursor: not-allowed; }
        .btn-green { background: #2ecc71; color: white; }
        .btn-gray { background: #95a5a6; color: white; }

        /* Sembunyikan registrasi & tampilkan kuis secara default */
        #registration-screen { display: none; }
        #quiz-screen { display: block; }
        #result-screen { display: none; }
    </style>
</head>
<body>

<div class="quiz-container">
    <div id="registration-screen">
        <h2 style="text-align: center; color: #2c3e50;">Biodata Peserta</h2>
        <div class="input-group">
            <label>Nama Lengkap</label>
            <input type="text" id="user-name" placeholder="Contoh: Budi Santoso">
        </div>
        <div class="input-group">
            <label>Nomor HP</label>
            <input type="number" id="user-phone" placeholder="0812xxxxxxxx">
        </div>
        <button class="btn btn-blue" id="btn-start" style="width: 100%" onclick="startQuiz()">Mulai Kuis Sekarang</button>
    </div>

    <div id="quiz-screen">
        <div class="status-container" id="status-container"></div>
        <hr style="border: 0; border-top: 1px solid #eee; margin-bottom: 20px;">
        <h3 id="question-text" style="color: #2c3e50; line-height: 1.4;">Memuat pertanyaan...</h3>
        <div id="options-container"></div>
        
        <div class="nav-buttons">
            <button class="btn btn-gray" id="prev-btn" onclick="prevQuestion()">Kembali</button>
            <button class="btn btn-blue" id="next-btn" onclick="nextQuestion()">Selanjutnya</button>
        </div>
        <button class="btn btn-green" id="finish-btn" style="width:100%; margin-top:10px;" onclick="showResult()">Selesaikan & Kirim Jawaban</button>
        <button class="btn btn-gray" id="back-to-result" style="width:100%; margin-top:10px; display:none;" onclick="exitReview()">Kembali ke Skor</button>
    </div>

    <div id="result-screen" style="text-align: center;">
        <h2 style="color: #2c3e50;">Hasil Skor Anda</h2>
        <p id="thank-you" style="font-size: 18px; color: #7f8c8d;"></p>
        <h1 id="final-score" style="font-size: 80px; color: #2ecc71; margin: 20px 0;">0</h1>
        
        <p style="font-size: 14px; margin-bottom: 10px; font-weight: bold;">Review Jawaban (Klik nomor):</p>
        <div class="status-container" id="result-summary-container"></div>

        <button class="btn btn-gray" onclick="location.reload()">Kembali ke Menu Utama</button>
    </div>
</div>

<script>
const quizData = [
    { q: "Jika (48 ÷ 6) × (15 − 7) = x, maka nilai x adalah ….", opt: ["48", "58", "64", "72"], a: 2 },
    { q: "Hasil dari 120 − (4 × 15) + 18 ÷ 3 adalah …", opt: ["66", "72", "84", "90"], a: 0 },
    { q: "Jika (36 ÷ 3) + (8 × 4) − 10 = x, maka x = …", opt: ["30", "34", "36", "38"], a: 1 },
    { q: "Nilai dari 75 − [5 × (6 − 3)] ÷ 5 adalah …", opt: ["70", "72", "74", "75"], a: 1 },
    { q: "Jika (90 ÷ 9) × 4 − 8 = x, maka x adalah …", opt: ["28", "32", "36", "40"], a: 1 },
    { q: "24 + 36 ÷ 6 × 2 = …", opt: ["32", "36", "48", "60"], a: 1 },
    { q: "(18 + 12) ÷ 6 × 4 = …", opt: ["16", "18", "20", "24"], a: 2 },
    { q: "50 − 20 ÷ 5 × 3 = …", opt: ["26", "32", "38", "44"], a: 2 },
    { q: "(40 ÷ 8) + 6 × 3 = …", opt: ["19", "21", "23", "25"], a: 2 },
    { q: "60 ÷ (5 + 5) × 4 = …", opt: ["20", "24", "30", "40"], a: 1 },
    { q: "3/4 + 1/2 = …", opt: ["4/6", "5/4", "3/2", "7/4"], a: 1 },
    { q: "9/10 ÷ 3/5 = …", opt: ["1", "3/2", "2", "3"], a: 1 },
    { q: "7/8 + 5/8 − 1/4 = …", opt: ["1", "11/8", "3/2", "5/4"], a: 3 },
    { q: "√16 + √9 = …", opt: ["5", "7", "9", "13"], a: 1 },
    { q: "3√5 − √5 = …", opt: ["√5", "2√5", "3√5", "4√5"], a: 1 },
    { q: "√12 + √27 = …", opt: ["3√3", "5√3", "6√3", "7√3"], a: 1 },
    { q: "√50 ÷ √2 = …", opt: ["5", "5√2", "10", "25"], a: 0 },
    { q: "2√8 = …", opt: ["4√2", "8√2", "16", "2√4"], a: 0 },
    { q: "Jika x = 4, nilai dari 3x + 5 adalah …", opt: ["12", "15", "17", "20"], a: 2 },
    { q: "Jika a = 6, nilai dari a² − 2a adalah …", opt: ["12", "18", "24", "36"], a: 2 },
    { q: "Jika p = 3, nilai dari 4p − p² adalah …", opt: ["3", "6", "9", "12"], a: 0 },
    { q: "Jika y = 5, nilai dari (2y ÷ 5) + 4 adalah …", opt: ["4", "5", "6", "7"], a: 2 },
    { q: "Jika m = 2, nilai dari 5m² − 3m adalah …", opt: ["8", "14", "16", "20"], a: 1 },
    { q: "Manakah yang paling besar?", opt: ["3/6", "55%", "0,6", "1/2"], a: 2 },
    { q: "Jika x = 4, manakah yang paling kecil?", opt: ["x − 1", "x ÷ 2", "0,75x", "3"], a: 1 },
    { q: "Urutan dari terkecil ke terbesar adalah …", opt: ["40%, 0,5, 2/5", "2/5, 40%, 0,5", "0,5, 40%, 2/5", "40%, 2/5, 0,5"], a: 1 },
    { q: "Jika y = 10, manakah yang paling besar?", opt: ["y ÷ 5", "25% dari y", "y − 7", "2"], a: 2 },
    { q: "Nilai terbesar adalah …", opt: ["0,75", "70%", "2/3", "0,6"], a: 0 },
    { q: "25% dari 200 adalah …", opt: ["40", "45", "50", "60"], a: 2 },
    { q: "Sebuah barang berharga Rp400.000 mendapat diskon 10%. Harga setelah diskon adalah …", opt: ["Rp360.000", "Rp370.000", "Rp380.000", "Rp390.000"], a: 0 },
    { q: "15% dari 80 adalah …", opt: ["10", "12", "14", "16"], a: 1 },
    { q: "Jika 20% = x dari 150, maka x = …", opt: ["20", "25", "30", "35"], a: 2 },
    { q: "Nilai meningkat dari 60 menjadi 72. Persentase kenaikan adalah …", opt: ["15%", "18%", "20%", "25%"], a: 2 },
    { q: "Ani membaca 12 halaman dalam 15 menit. Dalam 1 jam Ani membaca …", opt: ["36 halaman", "40 halaman", "45 halaman", "48 halaman"], a: 3 },
    { q: "Sebuah tangki penuh dalam 5 jam. Dalam 1 jam terisi …", opt: ["10%", "15%", "20%", "25%"], a: 2 },
    { q: "Rina menabung Rp2.000 setiap hari. Selama 15 hari tabungannya menjadi …", opt: ["Rp25.000", "Rp30.000", "Rp35.000", "Rp40.000"], a: 1 },
    { q: "Dalam kelas terdapat 40 siswa. Jika 60% perempuan, jumlah siswa laki-laki adalah …", opt: ["12", "14", "16", "18"], a: 2 },
    { q: "Lampu menyala 8 jam per hari. Selama 7 hari menyala selama …", opt: ["48 jam", "52 jam", "56 jam", "60 jam"], a: 2 },
    { q: "Perbandingan umur A dan B adalah 3 : 5. Jika umur A 18 tahun, umur B adalah …", opt: ["25", "27", "30", "32"], a: 2 },
    { q: "Perbandingan kelereng Andi dan Budi adalah 4 : 7. Jika Andi memiliki 20 kelereng, Budi memiliki …", opt: ["28", "30", "35", "40"], a: 2 },
    { q: "Perbandingan uang Sinta dan Rani adalah 2 : 3. Jika total Rp100.000, uang Rani adalah …", opt: ["Rp 40.000", "Rp 50.000", "Rp 60.000", "Rp 70.000"], a: 2 },
    { q: "Umur Ani 4 tahun lebih tua dari Budi. Jika umur Ani 20 tahun, umur Budi adalah …", opt: ["14", "15", "16", "17"], a: 2 },
    { q: "Harga buku Rp3.000 lebih murah dari pulpen. Jika harga pulpen Rp8.000, harga buku adalah …", opt: ["Rp 4.000", "Rp 5.000", "Rp 6.000", "Rp 7.000"], a: 1 },
    { q: "Jarak A ke B 60 km lebih jauh dari B ke C. Jika B ke C 40 km, maka A ke B adalah …", opt: ["80 km", "90 km", "100 km", "120 km"], a: 2 },
    { q: "Tiga tahun yang lalu, umur A dua kali umur B. Lima tahun yang akan datang, jumlah umur mereka 56 tahun. Umur A sekarang adalah …", opt: ["24 tahun", "25 tahun", "26 tahun", "27 tahun"], a: 3 },
    { q: "Umur seorang ayah saat ini 30 tahun lebih tua dari anaknya. Lima tahun yang lalu, umur ayah enam kali umur anak. Umur ayah sekarang adalah …", opt: ["41 tahun", "45 tahun", "48 tahun", "50 tahun"], a: 0 },
    { q: "Mobil melaju 60 km/jam selama 2 jam. Jarak tempuh adalah …", opt: ["100 km", "110 km", "120 km", "130 km"], a: 2 },
    { q: "Jarak 150 km ditempuh dalam 3 jam. Kecepatannya adalah …", opt: ["40 km/jam", "45 km/jam", "50 km/jam", "55 km/jam"], a: 2 },
    { q: "Sepeda menempuh 24 km dengan kecepatan 12 km/jam. Waktu yang diperlukan adalah …", opt: ["1 jam", "1,5 jam", "2 jam", "3 jam"], a: 2 },
    { q: "Seseorang berjalan 30 menit dengan kecepatan 6 km/jam. Jarak yang ditempuh adalah …", opt: ["2 km", "2,5 km", "3 km", "3,5 km"], a: 2 }
];

    let currentIdx = 0;
    let userName = "Peserta"; 
    let userAnswers = new Array(quizData.length).fill(null);
    let isReviewMode = false;

    window.onload = () => {
        renderStatus();
        showQuestion();
    };

    function renderStatus() {
        const container = document.getElementById('status-container');
        container.innerHTML = "";
        quizData.forEach((_, i) => {
            const box = document.createElement('div');
            box.innerText = i + 1;
            
            if (isReviewMode) {
                const isCorrect = userAnswers[i] === quizData[i].a;
                box.className = `num-box ${isCorrect ? 'num-correct' : 'num-wrong'}`;
            } else {
                box.className = `num-box ${userAnswers[i] !== null ? 'num-answered' : 'num-unanswered'}`;
            }
            
            if (i === currentIdx) box.classList.add('num-active');
            box.onclick = () => { currentIdx = i; showQuestion(); };
            container.appendChild(box);
        });
    }

    function showQuestion() {
        const q = quizData[currentIdx];
        document.getElementById('question-text').innerText = q.q;
        const optContainer = document.getElementById('options-container');
        optContainer.innerHTML = "";

        q.opt.forEach((option, i) => {
            const btn = document.createElement('button');
            btn.innerText = option;
            
            if (isReviewMode) {
                btn.disabled = true;
                if (i === q.a) btn.classList.add('correct-ans'); 
                if (userAnswers[currentIdx] === i && i !== q.a) btn.classList.add('selected'); 
                if (userAnswers[currentIdx] === i && i === q.a) btn.classList.add('selected'); 
            } else {
                btn.className = `option-btn ${userAnswers[currentIdx] === i ? 'selected' : ''}`;
                btn.onclick = () => selectAnswer(i);
            }
            
            btn.classList.add('option-btn');
            optContainer.appendChild(btn);
        });

        document.getElementById('prev-btn').style.visibility = currentIdx === 0 ? 'hidden' : 'visible';
        document.getElementById('next-btn').style.display = currentIdx === quizData.length - 1 ? 'none' : 'block';
        
        // Logika Tombol Selesai (Diperbarui)
        if (isReviewMode) {
            document.getElementById('finish-btn').style.display = 'none';
            document.getElementById('back-to-result').style.display = 'block';
        } else {
            // Tombol "Selesaikan" selalu muncul di setiap nomor
            document.getElementById('finish-btn').style.display = 'block';
            document.getElementById('back-to-result').style.display = 'none';
        }
        renderStatus();
    }

    function selectAnswer(i) {
        if (isReviewMode) return;
        userAnswers[currentIdx] = i;
        showQuestion();
    }

    function nextQuestion() {
        if (currentIdx < quizData.length - 1) {
            currentIdx++;
            showQuestion();
        }
    }

    function prevQuestion() {
        if (currentIdx > 0) {
            currentIdx--;
            showQuestion();
        }
    }

    function openReview(idx) {
        isReviewMode = true;
        currentIdx = idx;
        document.getElementById('result-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'block';
        showQuestion();
    }

    function exitReview() {
        isReviewMode = true; 
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
    }

    async function showResult() {
        const webAppUrl = "https://script.google.com/macros/s/AKfycbxjPj5_tWBdJB3m6TbORslq_MoGPMsmmVBpC2cm1CRHhe4MoLvtJ3Ne_9MiiDQIEPkZMw/exec";

        const unanswered = userAnswers.filter(ans => ans === null).length;
        if (unanswered > 0) {
            if (!confirm(`Ada ${unanswered} soal yang belum dijawab. Tetap kumpulkan?`)) return;
        }

        let correct = 0;
        const summaryContainer = document.getElementById('result-summary-container');
        summaryContainer.innerHTML = "";

        userAnswers.forEach((ans, i) => {
            const isCorrect = (ans === quizData[i].a);
            if (isCorrect) correct++;
            
            const box = document.createElement('div');
            box.innerText = i + 1;
            box.className = `num-box ${isCorrect ? 'num-correct' : 'num-wrong'}`;
            box.onclick = () => openReview(i);
            summaryContainer.appendChild(box);
        });

        const finalScoreValue = Math.round((correct / quizData.length) * 100);
        
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        document.getElementById('thank-you').innerText = "Sedang mengirim skor...";
        document.getElementById('final-score').innerText = "...";

        try {
            await fetch(webAppUrl, {
                method: 'POST',
                mode: 'no-cors', 
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    nama: userName,
                    skor: finalScoreValue,
                    tanggal: new Date().toLocaleString('id-ID')
                })
            });

            document.getElementById('thank-you').innerText = `Selesai! Berikut hasil Anda:`;
            document.getElementById('final-score').innerText = finalScoreValue;
            
        } catch (error) {
            document.getElementById('thank-you').innerText = `Koneksi bermasalah, skor Anda:`;
            document.getElementById('final-score').innerText = finalScoreValue;
        }
    }
</script>

</body>
</html>